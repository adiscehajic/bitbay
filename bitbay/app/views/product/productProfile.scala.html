@(product: Product)(path: String)(comments:List[Comment])(topComments: List[Comment])

@main("Product") {
		<div class="container">
			<div class="row">
				<div class="col-md-1"></div>
				<div class="col-md-4" style="margin-right: 5%">
					<div class="thumbnail">

						<img src="@routes.Assets.versioned("images/products/" + path)"/>

					</div>
				</div>
			</div>
			<div class="col-md-6" id="userInfo">
				<h2>@product.name</h2>
				<table>
					<tbody>
						<tr class="blank_row"></tr>
						<tr class="blank_row"></tr>

						<tr>
							<td> User: </td>
							<td name="email">@product.user.email</td>
						</tr>
						<tr>
							<td> Category: </td>
							<td>@product.category.name</td>
						</tr>
						<tr class="blank_row"></tr>
						<tr>
							<td> <h4> Price:</h4></td>
							<td> <h4>@product.price KM</h4></td>
						</tr>
						<tr class="blank_row"></tr>

						<tr>
							<td> Manifacturer: </td>
							<td>@product.manufacturer</td>
						</tr>
						<tr class="blank_row"></tr>
						<tr>
							<td>Quantity:</td>
							<td>@product.quantity</td>
						</tr>
						<tr>
							<td>Availability:</td>
							<td>Yes</td>
						</tr>
						<tr>
							<td> Payment: </td>
							<td> Paypal </td>
						</tr>
						<tr class="blank_row"></tr>
						<tr class="blank_row"></tr>
						<tr>
							<td>
								@if(session().get("email") != null && (User.getUserByEmail(session().get("email"))).userType.id == 2) {
									<form action="@routes.CartController.addToCart(product.id)" method="POST">
										<button type="submit " class="btn btn-primary" style="margin-bottom:20px">
											Add to cart </button>
									</form>
								}
								@if(session().get("email") != null && (User.getUserByEmail(session().get("email"))).userType.id == 3 && product.user.id == User.getUserByEmail(session().get("email")).id) {
									<form action="@routes.ProductController.editProduct(product.id)" method="GET">
										<button type="submit " class="btn btn-primary" style="margin-bottom:20px">
											Edit </button>
									</form>
								}
							</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
		<div class="row" >
			<div class="col-md-5" style="margin-right: 5%"></div>
			<div class="col-md-6" style="margin-top:20px" id="deliveryWrapper">
				<table>
					<tbody>
						<tr>
							<td> Shipping: </td>
							<td> </td>
						</tr>
						<tr>
							<td> Delivery: </td>
							<td> Estimated 10-15 days. </td>
						</tr>
						<tr>
							<td> Returns: </td>
							<td> 60 days money back, buyer pays return shipping </td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
		<div class="row" >
			<div class="col-md-1"></div>
			<div class="col-md-10">
				<ul class="nav nav-tabs">
					<li class="active"><a data-toggle="tab" href="#about">About</a></li>
					<li><a data-toggle="tab" href="#menu2">Comments (@(comments.size + topComments.size))</a></li>
				</ul>
				<div class="tab-content">
					<div id="about" class="tab-pane fade in active">
						<br><p>@product.description</p>
					</div>
					<div id="menu2" class="tab-pane fade">
						@if(session().get("email") != null && (User.getUserByEmail(session().get("email"))).userType.id == 2) {
							<div class="page-header">
								<h2>Your Comment </h2>
							</div>
							<div class = "row">
								<form action="@routes.CommentController.saveComment(product.id)" method="POST">
									<div class="form-group">
										<label for="usr" style = "margin-top:40px;">Tittle:</label>
										<input type="text" class="form-control" id="usr"  name="title">
										@if(flash.containsKey("saveCommentEmptyTitleError")) {
											<p  style="color: red;">
											@flash.get("saveCommentEmptyTitleError")
											</p>
										}
										<label for="comment" style = "margin-top:30px;">Comment:</label>
										<textarea class="form-control" rows="5" id="comment"  name="comment"></textarea>
										@if(flash.containsKey("saveCommentEmptyTextError")) {
											<p  style="color: red;">
											@flash.get("saveCommentEmptyTextError")
											</p>
										}
									</div>
									<div class = "row pull-right" >
										<button type="submit" class="btn btn-primary" style = "margin-right:14px;">Submit</button>
									</div>
								</form>
								<table class="table">
								}
						<thead>

							<tr>

								<th><h3>Top comments</h3></th>
							</tr>
						</thead>
						<tbody>

						@for(comment <- topComments){

							<tr>
								<td>
									<a href=""><h4>@comment.title</h4></a>
									<p class = "person">By @comment.user.firstName @comment.user.lastName on @comment.commentDate</p>
									<p style = "margin-bottom:20px;">@comment.text</p>
									<span style = "margin-right:6px; ">Was this review helpful to you?</span>
									<a id="like@comment.id"> <span id="thumbs-up@comment.id" class="glyphicon glyphicon-thumbs-up" style="padding-right: 10px; font-size: 17px;">@Thumb.getNumberThumbsUp(comment)</span></a>
									<a id="dislike@comment.id"> <span id="thumbs-down@comment.id" class="glyphicon glyphicon-thumbs-down" style="padding-right: 10px; font-size: 17px;">@Thumb.getNumberThumbsDown(comment)</span></a>
								</td>
							</tr>
							<script>

							$(document).ready(function() {
								var comm = @comment.id;
								var thumbUp = "true";
								var thumbDown = "false";
								$("#like" + comm).click(function(e) {
									e.preventDefault();
									$.ajax({
										type: "post",
										url: "@routes.CommentController.saveThumbUp()",
										data: "comm=" + comm + "&thumb=" + thumbUp
										}).success(function(response) {
											if (response === "1") {
												var number = @Thumb.getNumberThumbsUp(Comment.getCommentById(comment.id)) + 1;
												$("#thumbs-up" + comm).html(number);
											} else if(response === "2") {
												var number1 = @Thumb.getNumberThumbsUp(Comment.getCommentById(comment.id));
												$("#thumbs-up" + comm).html(number1);
												var number2 = @Thumb.getNumberThumbsDown(Comment.getCommentById(comment.id));
												$("#thumbs-down" + comm).html(number2);
											}
											$("#dislike" + comm).css('color', 'blue');
											$("#like" + comm).css('color', 'grey');
											})
										})
										$("#dislike" + comm).click(function(e) {
											e.preventDefault();
											$.ajax({
												type: "post",
												url: "@routes.CommentController.saveThumbUp()",
												data: "comm=" + comm + "&thumb=" + thumbDown
												}).success(function(response) {
													if (response === "1") {
														var number = @Thumb.getNumberThumbsDown(Comment.getCommentById(comment.id)) + 1;
														$("#thumbs-down" + comm).html(number);
													} else if (response === "2") {
														var number1 = @Thumb.getNumberThumbsDown(Comment.getCommentById(comment.id)) + 1;
														$("#thumbs-down" + comm).html(number1);
														var number2 = @Thumb.getNumberThumbsUp(Comment.getCommentById(comment.id)) - 1;
														$("#thumbs-up" + comm).html(number2);
													}
														$("#like" + comm).css('color', 'blue');
														$("#dislike" + comm).css('color', 'grey');
													})
												})
											});
										</script>
									}
						</tbody>
					</table>
					<table class="table">
						<thead>
							<tr>
								<th><h3>All comments</h3></th>
							</tr>
						</thead>
						<tbody>
							@for(comment <- comments) {
								<form action="" method="post">
									<tr>
										<td>
											<a href=""><h4>@comment.title</h4></a>
											<p class = "person">By @comment.user.firstName @comment.user.lastName on @comment.commentDate</p>
											<p style = "margin-bottom:20px;">@comment.text</p>
											<span style = "margin-right:6px; ">Was this review helpful to you?</span>

											<a id="like@comment.id"> <span id="thumbs-up@comment.id" class="glyphicon glyphicon-thumbs-up" style="padding-right: 10px; font-size: 17px;">@Thumb.getNumberThumbsUp(comment)</span></a>
											<a id="dislike@comment.id"> <span id="thumbs-down@comment.id" class="glyphicon glyphicon-thumbs-down" style="padding-right: 10px; font-size: 17px;">@Thumb.getNumberThumbsDown(comment)</span></a>
										</td>
									</tr>
								</form>

								<script>
									$(document).ready(function() {
										var comm = @comment.id;
										var thumbUp = "true";
										var thumbDown = "false";
										$("#like" + comm).click(function(e) {
											e.preventDefault();
											$.ajax({
											type: "post",
											url: "@routes.CommentController.saveThumbUp()",
											data: "comm=" + comm + "&thumb=" + thumbUp
										}).success(function(response) {
											if (response === "1") {
												var number = @Thumb.getNumberThumbsUp(Comment.getCommentById(comment.id)) + 1;
												$("#thumbs-up" + comm).html(number);
											} else if(response === "2") {
												var number1 = @Thumb.getNumberThumbsUp(Comment.getCommentById(comment.id));
												$("#thumbs-up" + comm).html(number1);
												var number2 = @Thumb.getNumberThumbsDown(Comment.getCommentById(comment.id));
												$("#thumbs-down" + comm).html(number2);
											}
												$("#dislike" + comm).css('color', 'blue');
												$("#like" + comm).css('color', 'grey');
											})
										})
										$("#dislike" + comm).click(function(e) {
											e.preventDefault();
											$.ajax({
												type: "post",
												url: "@routes.CommentController.saveThumbUp()",
												data: "comm=" + comm + "&thumb=" + thumbDown
											}).success(function(response) {
												if (response === "1") {
													var number = @Thumb.getNumberThumbsDown(Comment.getCommentById(comment.id)) + 1;
													$("#thumbs-down" + comm).html(number);
												} else if (response === "2") {
													var number1 = @Thumb.getNumberThumbsDown(Comment.getCommentById(comment.id)) + 1;
													$("#thumbs-down" + comm).html(number1);
													var number2 = @Thumb.getNumberThumbsUp(Comment.getCommentById(comment.id)) - 1;
													$("#thumbs-up" + comm).html(number2);
												}
												$("#like" + comm).css('color', 'blue');
												$("#dislike" + comm).css('color', 'grey');
											})
										})
									});
								</script>
							}
							</tbody>
						</table>
					</div>
					</div>
				</div>
			</div>
		</div>
	</div>

}