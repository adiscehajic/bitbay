@(products: List[Product])(user: User)

@main("User Profile", User.getUserByEmail(session.get("email"))) {

  <body>
        <div class="panel panel-primary">
          <div class="panel-heading">
            <div class="panel-title">@user.firstName</div>
          </div>
          <div class="panel-body">
            <table class="table table-hover">
              <htable>
                  <th> Name </th>
                  <th> Category </th>
                  <th> Quantity </th>
                  <th> Price </th>
                  <th> </th>
              </htable>
              <btable>
                @for(product <- products) {
                 <tr>
                    <td> @product.name </td>
                    <td> @product.category.name </td>
                    <td> @product.quantity</td>
                    <td> @product.price </td>
                    <td>
                        <a href="@routes.ProductController.editProduct(product.id)"><button type="submit"><span class="glyphicon glyphicon-edit"></span></button></a>
                        <a id="deleteProduct"><button type="submit"><span class="glyphicon glyphicon-trash"></span></button></a>
                    </td>
                 </tr>
                    <script >
                      $(document).ready(function(){
                      $('#deleteProduct').click(function(){
                         $.confirm({
                            title: 'Do you want to delete ' +'@product.name' + ' ?',
                            theme: 'white',
                            content: false,
                            confirmButtonClass: 'btn-danger',
                            cancelButtonClass: 'btn-info',
                            confirmButton: 'Delete',
                            cancelButton: 'Cancel',
                               confirm: function(){
                                $.ajax({
                                   url: '@routes.ProductController.deleteProduct(product.id)',
                                   method: 'GET',
                                    }).success(function(){
						             window.location.replace("@routes.Users.getAllUserProducts()");
                                      }).error(function(response){
                                      alert(response.responseText);
                                       });
                                       },
                                      cancel: function(){
                                    }
                               });
                             })
                         })
                     </script>

                }
              </btable>
            </table>
                 <a href="@routes.ProductController.newProduct()"><button type="submit" class="btn btn-primary"> Create new product </button></a>
          </div>
        </div>



}